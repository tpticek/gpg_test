---
  - name: Sentinel Service
    hosts: 
      - srv-t-ecmapp1
      - srv-t-ecmapp2
    tasks:
      - name: Start Sentinel service, if not started
        service:
          name: sentinel
          state: started
        become: yes

  - name: Restart Sentinel Service
    hosts:
      - srv-t-ecmapp1
      - srv-t-ecmapp2
    tasks:
      - name: Restart Sentinel service
        service:
          name: sentinel
          state: restarted
        become: yes
        when: sentinel_restart == 'yes'

  - name: Stop EOC SOM Side A
    hosts:
      - srv-t-eocapp1
      - srv-t-eocapp3
    roles:
      - role: jboss_stop_eoc
        when: eoc_stop_side_A == 'yes' and inventory_hostname in affected_servers

  - name: Stop ECM SOM Side A
    hosts:
      - srv-t-ecmapp1
    roles:
      - role: jboss_stop_ecm
        when: ecm_stop_side_A == 'yes' and inventory_hostname in affected_servers

  - name: Start ECM SOM Side A
    hosts:
      - srv-t-ecmapp1
    roles:
      - role: jboss_start_ecm
        when: ecm_start_side_A == 'yes' and inventory_hostname in affected_servers

  - name: Start EOC SOM Side A
    hosts:
      - srv-t-eocapp1
      - srv-t-eocapp3
    roles:
      - role: jboss_start_eoc
        when: eoc_start_side_A == 'yes' and inventory_hostname in affected_servers



  - name: Stop EOC SOM Side B
    hosts:
      - srv-t-eocapp2
      - srv-t-eocapp4
    roles:
      - role: jboss_stop_eoc
        when: eoc_stop_side_B == 'yes' and inventory_hostname in affected_servers

  - name: Stop ECM SOM Side B
    hosts:
      - srv-t-ecmapp2
    roles:
      - role: jboss_stop_ecm
        when: ecm_stop_side_B == 'yes' and inventory_hostname in affected_servers

  - name: Start ECM SOM Side B
    hosts:
      - srv-t-ecmapp2
    roles:
      - role: jboss_start_ecm
        when: ecm_start_side_B == 'yes' and inventory_hostname in affected_servers

  - name: Start EOC SOM Side B
    hosts:
      - srv-t-eocapp2
      - srv-t-eocapp4
    roles:
      - role: jboss_start_eoc
        when: eoc_start_side_B == 'yes' and inventory_hostname in affected_servers

# Restart EOC&ECM SOM Side A and Side B 
# ansible-playbook -i inventory-eocecm eoc_ecm_restart_Telia_LT_PROD_JSON.yml -v --extra-vars "sentinel_restart='no' eoc_stop_side_A='yes' ecm_stop_side_A='yes' ecm_start_side_A='yes' eoc_start_side_A='yes' eoc_stop_side_B='yes' ecm_stop_side_B='yes' ecm_start_side_B='yes' eoc_start_side_B='yes'"
# ansible-playbook -i inventory-eocecm eoc_ecm_restart_Telia_LT_PROD_JSON.yml -v --extra-vars '{"affected_servers": ["srv-t-ecmapp1", "srv-t-eocapp1", "srv-t-eocapp3", "srv-t-ecmapp2", "srv-t-eocapp2", "srv-t-eocapp4"], "sentinel_restart": "no", "eoc_stop_side_A": "yes", "ecm_stop_side_A": "yes", "ecm_start_side_A": "yes", "eoc_start_side_A": "yes", "eoc_stop_side_B": "yes", "ecm_stop_side_B": "yes", "ecm_start_side_B": "yes", "eoc_start_side_B": "yes"}'
# ansible-playbook -i inventory-eocecm eoc_ecm_restart_Telia_LT_PROD_JSON.yml -v --extra-vars '{"affected_servers": [${bamboo.variable_affected_servers}], "sentinel_restart": "${bamboo.variable_sentinel_restart}", "eoc_stop_side_A": "${bamboo.variable_eoc_stop_side_A}", "ecm_stop_side_A": "${bamboo.variable_ecm_stop_side_A}", "ecm_start_side_A": "${bamboo.variable_ecm_start_side_A}", "eoc_start_side_A": "${bamboo.variable_eoc_start_side_A}", "eoc_stop_side_B": "${bamboo.variable_eoc_stop_side_B}", "ecm_stop_side_B": "${bamboo.variable_ecm_stop_side_B}", "ecm_start_side_B": "${bamboo.variable_ecm_start_side_B}", "eoc_start_side_B": "${bamboo.variable_eoc_start_side_B}"}'
# ansible-playbook -i inventory-eocecm eoc_ecm_restart_Telia_LT_PROD_JSON.yml -v --extra-vars "sentinel_restart='${bamboo.variable_sentinel_restart}' eoc_stop_side_A='${bamboo.variable_eoc_stop_side_A}' ecm_stop_side_A='${bamboo.variable_ecm_stop_side_A}' ecm_start_side_A='${bamboo.variable_ecm_start_side_A}' eoc_start_side_A='${bamboo.variable_eoc_start_side_A}' eoc_stop_side_B='${bamboo.variable_eoc_stop_side_B}' ecm_stop_side_B='${bamboo.variable_ecm_stop_side_B}' ecm_start_side_B='${bamboo.variable_ecm_start_side_B}' eoc_start_side_B='${bamboo.variable_eoc_start_side_B}'"
# ansible-playbook extra_var_json.yml -e '{"my_float": 1.618, "my_list": ["HGTTG", 42], "my_string": "Time is an illusion."}'

# Restart EOC&ECM SOM Side A
# ansible-playbook -i inventory-eocecm eoc_ecm_restart_Telia_LT_PROD_JSON.yml -v --extra-vars "sentinel_restart='no' eoc_stop_side_A='yes' ecm_stop_side_A='yes' ecm_start_side_A='yes' eoc_start_side_A='yes' eoc_stop_side_B='no' ecm_stop_side_B='no' ecm_start_side_B='no' eoc_start_side_B='no'"

# Restart EOC&ECM SOM Side B
# ansible-playbook -i inventory-eocecm eoc_ecm_restart_Telia_LT_PROD_JSON.yml -v --extra-vars "sentinel_restart='no' eoc_stop_side_A='no' ecm_stop_side_A='no' ecm_start_side_A='no' eoc_start_side_A='no' eoc_stop_side_B='yes' ecm_stop_side_B='yes' ecm_start_side_B='yes' eoc_start_side_B='yes'"

# Restart EOC SOM Side A and Side B 
# ansible-playbook -i inventory-eocecm eoc_ecm_restart_Telia_LT_PROD_JSON.yml -v --extra-vars "sentinel_restart='no' eoc_stop_side_A='yes' ecm_stop_side_A='no' ecm_start_side_A='no' eoc_start_side_A='yes' eoc_stop_side_B='yes' ecm_stop_side_B='no' ecm_start_side_B='no' eoc_start_side_B='yes'"

# Restart ECM SOM Side A and Side B 
# ansible-playbook -i inventory-eocecm eoc_ecm_restart_Telia_LT_PROD_JSON.yml -v --extra-vars "sentinel_restart='no' eoc_stop_side_A='no' ecm_stop_side_A='yes' ecm_start_side_A='yes' eoc_start_side_A='no' eoc_stop_side_B='no' ecm_stop_side_B='yes' ecm_start_side_B='yes' eoc_start_side_B='no'"
